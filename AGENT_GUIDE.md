# 🤖 راهنمای Agent - پروژه سیستم مدیریت انبار و BOM

## 📋 خلاصه اجرایی پروژه

**نام پروژه**: سیستم مدیریت انبار و BOM (Bill of Materials)  
**نوع کسب و کار**: شرکت تولیدکننده دستگاه‌های صنعتی  
**هدف اصلی**: مدیریت انبار قطعات و محاسبه خودکار نیازمندی‌های تولید  
**وضعیت فعلی**: فاز 2 (مدیریت BOM) در حال تکمیل  

## 🎯 اهداف کلیدی

### فاز 1: مدیریت انبار ✅ (تکمیل شده)
- ثبت دقیق موجودی انبار
- ورود اطلاعات از فایل CSV/Excel
- گزارش‌گیری از وضعیت موجودی
- تبدیل تاریخ‌ها به شمسی

### فاز 2: مدیریت BOM و دستگاه‌ها 🚧 (در حال انجام)
- تعریف دستگاه‌ها و مشخصات آن‌ها
- ثبت لیست قطعات مورد نیاز (BOM) برای هر دستگاه
- مدیریت تامین‌کنندگان قطعات
- ارتباط BOM با موجودی انبار

### فاز 3: مدیریت سفارشات تولید 📋 (برنامه‌ریزی شده)
- ثبت سفارش تولید با تعداد دستگاه‌های مورد نیاز
- محاسبه خودکار قطعات مورد نیاز
- تولید لیست خرید با گروه‌بندی بر اساس تامین‌کننده
- کم کردن موجودی انبار هنگام شروع تولید

## 🗂️ ساختار فایل‌های پروژه

### فایل‌های اصلی (فاز 1)
- `index.php` - صفحه اصلی و داشبورد
- `new_inventory.php` - ثبت انبارگردانی جدید
- `save_inventory.php` - ذخیره اطلاعات انبارگردانی (AJAX)
- `view_inventories.php` - مشاهده گزارش‌های انبارگردانی
- `import_inventory.php` - ورود اطلاعات از CSV
- `export_csv.php` - خروجی CSV

### فایل‌های BOM (فاز 2)
- `devices.php` - مدیریت دستگاه‌ها
- `new_device.php` - افزودن دستگاه جدید
- `device_bom.php` - مدیریت لیست قطعات هر دستگاه
- `suppliers.php` - مدیریت تامین‌کنندگان
- `new_supplier.php` - افزودن تامین‌کننده جدید
- `edit_supplier.php` - ویرایش تامین‌کننده
- `supplier_parts.php` - قطعات هر تامین‌کننده

### فایل‌های سفارشات تولید (فاز 3)
- `production_orders.php` - لیست سفارشات تولید
- `new_production_order.php` - ثبت سفارش جدید
- `production_order.php` - جزئیات سفارش
- `confirm_production_order.php` - تایید سفارش
- `start_production.php` - شروع تولید

### فایل‌های پایه
- `config.php` - تنظیمات دیتابیس و عمومی
- `includes/functions.php` - توابع کمکی
- `db.sql` - اسکریپت اولیه دیتابیس
- `db_update_v2.sql` - بروزرسانی دیتابیس فاز 2

## 🗄️ ساختار دیتابیس

### جداول فاز 1 (انبار)
- `inventory_sessions` - جلسات انبارگردانی
- `inventory_records` - رکوردهای موجودی انبار
- `migrations` - مدیریت بروزرسانی‌های دیتابیس

### جداول فاز 2 (BOM)
- `devices` - اطلاعات دستگاه‌ها
- `device_bom` - لیست قطعات مورد نیاز هر دستگاه
- `suppliers` - اطلاعات تامین‌کنندگان

### جداول فاز 3 (تولید)
- `production_orders` - سفارشات تولید
- `production_order_items` - جزئیات سفارش تولید

## 🔑 قوانین و محدودیت‌های کاری

### ورود اطلاعات
1. کد دستگاه‌ها باید یکتا باشد
2. کد قطعات با فرمت شرکت مطابقت داشته باشد
3. تمامی قطعات باید کد تامین‌کننده داشته باشند
4. موجودی منفی مجاز نیست

### محاسبات
1. حداقل موجودی برای هر قطعه باید تعریف شود
2. هشدار برای قطعات با موجودی کمتر از حد مجاز
3. محاسبه نیازها بر اساس: BOM × تعداد دستگاه - موجودی فعلی

## 🚨 مسائل شناخته شده و نیازهای فوری

### مشکلات فعلی
1. خطای `Unknown column 'item_code'` - نیاز به بروزرسانی ساختار دیتابیس
2. خطای collation در MySQL - نیاز به تنظیم یکسان charset
3. نمایش موجودی نادرست در `production_order.php`
4. خطای تامین‌کننده ندارد باید صرف‌نظر شود و لیست قابل پرینت نمایش داده شود

### اولویت‌های توسعه
1. **فوری**: رفع خطاهای ساختار دیتابیس
2. **مهم**: تکمیل صفحه مدیریت تامین‌کنندگان
3. **متوسط**: بهبود UI/UX و قابلیت پرینت گزارش‌ها
4. **آینده**: پیاده‌سازی داشبورد تحلیلی

## 💻 تکنولوژی‌ها و ابزارها

### Backend
- **PHP 7.4+** - زبان اصلی برنامه‌نویسی
- **MySQL 5.7+** - پایگاه داده
- **MySQLi** - اتصال به دیتابیس

### Frontend
- **Bootstrap 5.3** RTL - فریمورک CSS
- **JavaScript/jQuery** - تعامل کاربری
- **Bootstrap Icons** - آیکون‌ها

### Development Tools
- **Git** - کنترل نسخه
- **Branch**: `feature/production-management` (فعلی)
- **Composer** - مدیریت وابستگی‌ها (در صورت نیاز)

## 📂 مستندات مهم

### فایل‌های مستندات در پوشه `docs/`
- `BUSINESS_REQUIREMENTS.md` - نیازمندی‌های کسب‌و‌کار
- `TECHNICAL.md` - مستندات فنی پروژه
- `USER_GUIDE.md` - راهنمای کاربری
- `DAILY_LOG.md` - گزارش تغییرات روزانه
- `LEARNING_GUIDE.md` - راهنمای یادگیری

### فایل‌های راه‌اندازی
- `README.md` - معرفی کلی پروژه
- `INSTALL.md` - راهنمای نصب
- `CHANGELOG.md` - تاریخچه تغییرات

## 🛠️ دستورالعمل‌های توسعه

### شروع کار با پروژه
1. بررسی فایل `config.php` برای تنظیمات دیتابیس
2. اجرای `db.sql` و `db_update_v2.sql` در صورت نیاز
3. بررسی branch فعلی: `feature/production-management`
4. مطالعه `docs/BUSINESS_REQUIREMENTS.md` برای درک نیازها

### اولویت‌های فوری
1. **رفع خطای ساختار دیتابیس**: اضافه کردن ستون‌های لازم
2. **بهبود قابلیت پرینت**: ایجاد قالب‌های مناسب برای چاپ
3. **تکمیل workflow تولید**: از ثبت سفارش تا شروع تولید

### استانداردهای کدنویسی
- استفاده از `clean()` function برای sanitize کردن ورودی‌ها
- استفاده از prepared statements در صورت امکان
- کامنت‌گذاری به زبان فارسی
- رعایت ساختار فایل‌های موجود

## 🎯 نقشه راه آینده

### کوتاه‌مدت (1-2 هفته)
- رفع خطاهای موجود
- تکمیل workflow سفارش تولید
- بهبود UI گزارش‌ها

### میان‌مدت (1-2 ماه)
- پیاده‌سازی داشبورد مدیریتی
- افزودن سیستم اعلان‌ها
- بهینه‌سازی performance

### بلندمدت (3-6 ماه)
- پیاده‌سازی API
- ایجاد اپلیکیشن موبایل
- ارتباط با سیستم‌های ERP

---

## 📞 نکات مهم برای Agent جدید

1. **همیشه ابتدا فایل‌های مستندات را بخوانید**
2. **قبل از تغییر، branch جدید ایجاد کنید**
3. **تغییرات database را با احتیاط اعمال کنید**
4. **کدهای PHP را همیشه test کنید**
5. **UI باید responsive و RTL باشد**
6. **از Bootstrap 5.3 RTL استفاده کنید**
7. **پیام‌های خطا باید به فارسی باشند**
8. **قابلیت پرینت برای گزارش‌ها الزامی است**

**آخرین بروزرسانی**: 7 مرداد 1404  
**وضعیت پروژه**: فعال و در حال توسعه  
**سطح اولویت**: بالا 🔥
